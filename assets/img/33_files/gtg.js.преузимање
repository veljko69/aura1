/*$(function() {

    //add to cart
    $(document).ready(function() {


    });

});*/

function google_metricData(metricData, typePage){

    //track lead users
    //gtg_trackLead();
    gtg_trackFilterProducts();
    gtg_Search();
    gtg_GoogleLogin();
    gtg_viewPage(metricData,typePage);
    var pagename;

    //track content view and events by type page
    switch(typePage) {

        case 'home':
            pagename = 'home';
            gtg_viewPage(metricData,typePage);

            break;
        case 'page':
            pagename = 'page';
            gtg_viewPage(metricData,typePage);

            break;

        case 'product':
            gtg_viewProductPage(metricData);

            break;

        case 'product_list':

            break;

        case 'cart':
            pagename = 'cart';
            gtg_viewPage(metricData,pagename);
            gtg_InitiateCheckout();
            gtg_AddPaymentInfo();
            gtg_deliveryOptions();
            //gtg_RemoveFromCart();
            break;

        case 'cart_confirm':
            //print in confirm page

            break;

        case 'confirm_registration':
            gtg_CompleteRegistration();
            break;

        case 'article_details':
            gtg_viewArticleDetails(metricData);
            break;

        default:

            break;

    }

}

function gtg_viewPage(metricData,pagename){
    gtag('event', 'page_view', {
        'pagetype': ''+pagename+'',
        'page_name': ''+metricData.name+'',
        'page_lang': ''+metricData.lang+'',
        'userAgent': ''+navigator.userAgent+'',
        'language': ''+navigator.language+'',
    });

    //fbq('trackCustom', 'MyCustomEvent', {custom_param: 'custom_value'});

}

function gtg_viewArticleCategory(metricData){

    gtag('event', 'page_view', {
        'pagetype': 'article_category',
        'page_name': ''+metricData.name+'',
        'bread_crumbs': ''+metricData.breadCrumbs+'',
        'page_lang': ''+metricData.lang+'',
        'userAgent': ''+navigator.userAgent+'',

    });


}

function gtg_viewArticleDetails(metricData){

    gtag('event', 'page_view', {
        'pagetype': 'article_details',
        'page_name': ''+metricData.name+'',
        'bread_crumbs': ''+metricData.breadCrumbs+'',
        'page_lang': ''+metricData.lang+'',
        'userAgent': ''+navigator.userAgent+'',

    });

}


function gtg_viewProductPage(metricProduct){
    gtag('event', 'page_view', {
        'dynx_itemid': ''+metricProduct.id+'',
        'dynx_itemid2': ''+metricProduct.productCode+'',
        'dynx_itemtitle': ''+metricProduct.name+'',
        'dynx_pagetype': 'offerdetail ',
        'dynx_category': ''+metricProduct.categoryName+'',
        'dynx_totalvalue': metricProduct.price,
        'dnyx_currency': ''+metricProduct.currency+''
    });


    //append event for click to add to cart and add to wishlist
    gtg_addToCart(metricProduct);
    gtg_AddToWishlist(metricProduct);
}


function gtg_addToCart(metricProduct){

    var button = document.getElementById('nb_addToCartButton');
    var quantity;
    var gtagAddToCart = false;

    button.addEventListener(
        'click',
        function() {
             quantity = document.getElementById('product_quantity');

            if(!gtagAddToCart){
                gtag('event', 'add_to_cart', {
                    'id': ''+metricProduct.id+'',
                    'name': ''+metricProduct.name+'',
                    'brand': ''+metricProduct.brand+'',
                    'category': ''+metricProduct.categoryName+'',
                    'quantity': ''+quantity.value+'',
                    'price': metricProduct.price
                });
                gtagAddToCart = true;
            }
        },
        false
    );

}

function gtg_AddToWishlist(metricProduct){

    var gtgAddToWishlist     = false;

    $('.product-wishlist-add').click( function() {

        if(!gtgAddToWishlist){

            gtag('event', 'add_to_wishlist', {
                'id': ''+metricProduct.id+'',
                'name': ''+metricProduct.name+'',
                'brand': ''+metricProduct.brand+'',
                'category': ''+metricProduct.categoryName+'',
                'price': metricProduct.price
            });

            gtgAddToWishlist = true;
        }

    });

}

function gtg_InitiateCheckout(){
    //InitiateCheckout
    gtag('event', 'begin_checkout');
}

function gtg_CompleteRegistration(){
    gtag('event', 'complete_registration', {
        'event_category': 'registration',
        'event_action': 'complete_registration'});
}

function gtg_trackLead(){

    // Delay pixel fire by 3 seconds
    var seconds = 3;
    setTimeout(function() {
        gtag('event', 'generate_lead');
    }, seconds * 1000);

}

function gtg_trackFilterProducts(){
    //cusstom event for filter
    $('.nb-filter').click( function() {
        var filterValue = $(this).attr('nb-value');

        if($(this).is(':checked') ){
                gtag('event', 'view_item_list', {'list_name': ''+filterValue+''});
        }
    });

}

function gtg_AddPaymentInfo(){

    //AddPaymentInfo
    var gtgAddPaymentInfo = false;

    $('.cart-payment-wrapper .delivery-options li').click( function() {
        var selValue;
        var seconds = 1;
        setTimeout(function() {
            selValue = $('input[name=typepayment]:checked').val();

            gtag('event', 'set_checkout_option', {
                'checkout_step': 'onepage',
                'checkout_option': 'payment info',
                'value': ''+selValue+''
            });

        }, seconds * 1000);

    });

}

function gtg_deliveryOptions(){
    var delivery_name;

$('.delivery-options li').click(function(){
    delivery_name = $(this).find('.delivery-option-text > strong').text();
    if (typeof delivery_name === 'undefined'){
        delivery_name ='';
    }

    gtag('event', 'set_checkout_option', {
        'checkout_step': 'onepage',
        'checkout_option': 'shipping method',
        'value': ''+delivery_name+''
    });
});

}

function gtg_SearchTimeWait(f, delay){
    var timer = null;
    return function(){
        var context = this, args = arguments;
        clearTimeout(timer);
        timer = window.setTimeout(function(){
                f.apply(context, args);
            },
            delay || 500);
    };
}


function gtg_Search(){

    $('#search-text').keyup(gtg_SearchTimeWait(function(){

        var searchString = $('#search-text').val();
        gtag('event', 'search', {
            'search_term': ''+searchString+''
        });

    }));

}
function gtg_GoogleLogin(){
    $('.btn-google').click(function(){
        gtag('event', 'login', {
            'method' : 'Google'
        });
    });
}


